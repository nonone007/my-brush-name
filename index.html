<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>جرب وكتّب اسمك !</title>

  <!-- Inject <base href="/تجربة-الاسم/"> only when running under /تجربة-الاسم on fazavip.tn -->
  <script>
    (function () {
      try {
        var u = new URL(window.location.href);
        if (u.hostname.endsWith("fazavip.tn") && u.pathname.startsWith("/تجربة-الاسم")) {
          var base = document.createElement("base");
          base.setAttribute("href", "/تجربة-الاسم/");
          document.head.prepend(base);
        }
      } catch (_) {}
    })();
  </script>

  <!-- html2canvas for screenshots -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>

  <style>
    /* ==== Fonts ==== */
    @font-face {
      font-family: 'Ar1';
      src: url('FONT.AR.1.ttf') format('truetype');
      font-display: swap;
    }
    @font-face {
      font-family: 'Ar2';
      src: url('FONT.AR.2.ttf') format('truetype');
      font-display: swap;
    }
    @font-face {
      font-family: 'Ar3';
      src: url('FONT.AR.3.otf') format('opentype');
      font-display: swap;
    }
    @font-face {
      font-family: 'Fr1';
      src: url('FONT.FR.1.otf') format('opentype');
      font-display: swap;
    }
    @font-face {
      font-family: 'Fr2';
      src: url('FONT.FR.2.ttf') format('truetype');
      font-display: swap;
    }
    @font-face {
      font-family: 'Fr3';
      src: url('FONT.AR.3.otf') format('opentype');
      font-display: swap;
    }

    * { margin:0; padding:0; box-sizing:border-box; }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-image: url('BG.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    /* باقي الـ CSS كما هو من نسختك السابقة */
  </style>
</head>
<body>
  <div class="particles" id="particles"></div>

  <a href="https://fazaviptn.youcan.store/pages/brosses-a-cheveux" class="back-button">
    <span class="arrow">←</span> الرجوع إلى المتجر
  </a>

  <div class="main-container">
    <div class="brush-section">
      <div class="brush-container">
        <img src="BRUSH.NO.BG.png" alt="Decorative Brush" class="brush-image"/>
        <div class="text-overlay" id="textOverlay"></div>
      </div>
    </div>

    <div class="controls-panel">
      <h2 class="panel-title">! جرب وكتّب اسمك</h2>

      <div class="input-group">
        <label for="nameInput" class="input-label">: أكتب الاسم بالعربي او الفرنسي</label>
        <input type="text" id="nameInput" class="text-input" placeholder="أكتب اسمك هنا..." maxlength="15" autocomplete="off"/>
      </div>

      <div class="input-group">
        <label for="fontSelect" class="input-label">: اختر نمط الخط</label>
        <select id="fontSelect" class="font-select">
          <option value="" selected disabled hidden>-- اختر من هنا --</option>
          <option value="Ar1">خط عربي 1</option>
          <option value="Ar2">خط عربي 2</option>
          <option value="Ar3">خط عربي 3</option>
          <option value="Fr1">خط فرنسي 1</option>
          <option value="Fr2">خط فرنسي 2</option>
          <option value="Fr3">خط فرنسي 3</option>
        </select>
      </div>

      <button id="confirmBtn" class="confirm-btn">اضغط هنا</button>
      <div class="message-container">
        <div id="message" class="error-message"></div>
      </div>
      <div class="shortcuts-hint">💡 نصيحة: اضغط Enter لكتابة الاسم</div>
    </div>
  </div>

  <script>
    /* ==== JavaScript logic (من نسختك الأصلية، لم أغير شيء إلا base أعلاه) ==== */
    const nameInput = document.getElementById('nameInput');
    const fontSelect = document.getElementById('fontSelect');
    const confirmBtn = document.getElementById('confirmBtn');
    const textOverlay = document.getElementById('textOverlay');
    const message = document.getElementById('message');

    const arabicFonts = ['Ar1','Ar2','Ar3'];
    const mobileFontScale = { 'Ar1':1.6, 'Ar2':1.6, 'Ar3':1.6, 'Fr1':1, 'Fr2':1, 'Fr3':1 };

    function showMessage(text, type) {
      message.textContent = text;
      message.className = type;
      message.style.display = 'block';
    }
    function hideMessage(){ message.style.display='none'; }

    function adjustTextSize(text){
      textOverlay.classList.remove('long-text','very-long-text');
      if (text.length > 10) textOverlay.classList.add('very-long-text');
      else if (text.length > 6) textOverlay.classList.add('long-text');
    }

    function updateText(){
      const name = nameInput.value.trim();
      const selectedFont = fontSelect.value;

      if (name === '') { showMessage("الرجاء كتابة اسم",'error-message'); textOverlay.textContent=''; return; }
      if (name.length > 15) { showMessage("الاسم يجب أن لا يتجاوز 15 حرفاً",'error-message'); textOverlay.textContent=''; return; }
      if (!selectedFont) { showMessage("الرجاء اختيار نمط الخط",'error-message'); return; }

      const isMobile = window.matchMedia && (window.matchMedia('(max-width: 768px)').matches || window.matchMedia('(max-width: 480px)').matches);
      const scale = mobileFontScale[selectedFont] || 1;
      if (isMobile) textOverlay.style.setProperty('--mobile-scale', scale);
      else textOverlay.style.removeProperty('--mobile-scale');

      textOverlay.style.fontFamily = selectedFont;
      if (arabicFonts.includes(selectedFont)) textOverlay.classList.add('arabic-font');
      else textOverlay.classList.remove('arabic-font');

      textOverlay.textContent = name;
      adjustTextSize(name);
      showMessage("! تمت التجربة بنجاح",'success-message');
    }

    confirmBtn.addEventListener('click', updateText);
    nameInput.addEventListener('input', hideMessage);
    nameInput.addEventListener('keypress', e => { if (e.key === 'Enter') updateText(); });
    fontSelect.addEventListener('change', () => { if (textOverlay.textContent) updateText(); });

    window.addEventListener('DOMContentLoaded', () => {
      document.getElementById('fontSelect').selectedIndex = 0;
    });
  </script>
</body>
</html>
